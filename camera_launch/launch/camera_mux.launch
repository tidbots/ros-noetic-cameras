<launch>
  <arg name="default_source" default="webcam"/>

  <!-- Inputs -->
  <arg name="webcam_rgb"  default="/webcam/image_raw"/>
  <arg name="webcam_info" default="/webcam/camera_info"/>

  <arg name="xtion_rgb"        default="/xtion/rgb/image_raw"/>
  <arg name="xtion_info"       default="/xtion/rgb/camera_info"/>
  <arg name="xtion_depth"      default="/xtion/depth/image_raw"/>
  <arg name="xtion_depth_info" default="/xtion/depth/camera_info"/>
  <arg name="xtion_points"     default="/xtion/depth/points"/>

  <arg name="rs_rgb"        default="/realsense/color/image_raw"/>
  <arg name="rs_info"       default="/realsense/color/camera_info"/>
  <arg name="rs_depth"      default="/realsense/depth/image_rect_raw"/>
  <arg name="rs_depth_info" default="/realsense/depth/camera_info"/>
  <arg name="rs_points"     default="/realsense/depth/points"/>

  <!-- Mux nodes (start with xtion first; selector will switch according to default_source) -->
  <node pkg="topic_tools" type="mux" name="mux_rgb_image" output="screen"
        args="/camera/rgb/image_raw $(arg xtion_rgb) $(arg webcam_rgb) $(arg rs_rgb)" />
  <node pkg="topic_tools" type="mux" name="mux_rgb_info" output="screen"
        args="/camera/rgb/camera_info $(arg xtion_info) $(arg webcam_info) $(arg rs_info)" />

  <node pkg="topic_tools" type="mux" name="mux_depth_image" output="screen"
        args="/camera/depth/image_raw $(arg xtion_depth) $(arg rs_depth)" />
  <node pkg="topic_tools" type="mux" name="mux_depth_info" output="screen"
        args="/camera/depth/camera_info $(arg xtion_depth_info) $(arg rs_depth_info)" />
  <node pkg="topic_tools" type="mux" name="mux_points" output="screen"
        args="/camera/depth/points $(arg xtion_points) $(arg rs_points)" />

  <!-- Selector node -->
  <node pkg="camera_launch" type="mux_select.py" name="mux_select" output="screen">
    <param name="default_source" value="$(arg default_source)"/>

    <param name="webcam_rgb" value="$(arg webcam_rgb)"/>
    <param name="webcam_info" value="$(arg webcam_info)"/>

    <param name="xtion_rgb" value="$(arg xtion_rgb)"/>
    <param name="xtion_info" value="$(arg xtion_info)"/>
    <param name="xtion_depth" value="$(arg xtion_depth)"/>
    <param name="xtion_depth_info" value="$(arg xtion_depth_info)"/>
    <param name="xtion_points" value="$(arg xtion_points)"/>

    <param name="rs_rgb" value="$(arg rs_rgb)"/>
    <param name="rs_info" value="$(arg rs_info)"/>
    <param name="rs_depth" value="$(arg rs_depth)"/>
    <param name="rs_depth_info" value="$(arg rs_depth_info)"/>
    <param name="rs_points" value="$(arg rs_points)"/>
  </node>
</launch>

